<div class="details-container">

  <header>
    <h1>{{ device()?.name }}</h1>
    <div class="subtitle-row">
      <span class="chip-id">ID: {{ deviceId() }}</span>
      @if (device()?.company) {
        <span class="chip-company">{{ device()?.company }}</span>
      } @else {
        <span class="chip-individual">Individual</span>
      }
    </div>
  </header>

  <div class="grid-layout">

    <!-- BAL: Info + Owner -->
    <div class="left-col">
      <mat-card class="info-card">
        <mat-card-header>
          <mat-card-title>Device Details</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="row"><span>Topic:</span> <strong class="mono">{{ device()?.topic }}</strong></div>
          <div class="row"><span>Type:</span> <strong>{{ device()?.type }}</strong></div>
          <div class="row"><span>Time Interval:</span> <strong>{{ device()?.timeInterval }}s</strong></div>
          <div class="row"><span>Registrated:</span> <span>{{ device()?.registeredAt | date }}</span></div>
        </mat-card-content>
      </mat-card>

      <!-- TULAJDONOS KÁRTYA -->
      <mat-card class="owner-card">
        <mat-card-header>
          <mat-card-title>Owner</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @let owner = ownerDetails();
          @if (owner) {
            <div class="owner-info">
              <div class="owner-name">{{ owner.name }}</div>
              <div class="owner-email">{{ owner.email }}</div>
              <div class="owner-badges">
                <span class="badge-role">{{ owner.role }}</span>
                @if (owner.type === 'company') {
                  <span class="badge-org">{{ owner.organizationName }}</span>
                }
              </div>
            </div>
          } @else {
            <!-- Ha még tölt, vagy nem találtuk, kiírjuk az emailt -->
            <div class="owner-simple">{{ device()?.ownerUserName }}</div>
          }
        </mat-card-content>
      </mat-card>

      <!-- LIVE METRIC -->
      <mat-card class="metric-card">
        <mat-card-content>
          <h3>Live Data</h3>
          <div class="big-value">{{ lastValue() }}</div>
          <div class="timestamp">Last Updated: {{ lastUpdated() }}</div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- JOBB: Chart -->
    <div class="right-col">
      <mat-card class="chart-card">
        <mat-card-content class="chart-box">
          @let opts = chartOption();
          @if (opts) {
            <div echarts [options]="opts" class="echart"></div>
          } @else {
            <div class="waiting">Waiting for Data...</div>
          }
        </mat-card-content>
      </mat-card>
    </div>

  </div>
</div>
